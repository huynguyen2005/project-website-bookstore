extends ../../layouts/default
include ../../mixins/search.pug
include ../../mixins/formatDateTime.pug

block main
  if(role.permissions.includes("roles_view"))

    // --- Thẻ card chứa toàn bộ nội dung ---
    .card
      .card-header.d-flex.justify-content-between.align-items-center
        h5.mb-0 Danh sách nhóm quyền

        if(role.permissions.includes("roles_create"))
          a.btn.btn-primary(href=`${prefixAdmin}/roles/create`)
            | + Thêm mới

      .card-body
        // --- Thanh tìm kiếm ---
        .d-flex.align-items-center.mb-3
          +search(keyword, "roles")

        // --- Bảng danh sách nhóm quyền ---
        table.table.table-hover.table-bordered(check-box-multi)
          thead.thead-light
            tr
              th
                input(type="checkbox" check-box-all)
              th Nhóm quyền
              th Mô tả ngắn
              th Người tạo
          tbody
            if records.length
              each record in records
                tr
                  td
                    input(type="checkbox" name="id" value=record.id)
                  td
                    strong #{record.title}
                    br
                    a(href="javascript:;" data-id=record.id button-detail) Xem
                    if(role.permissions.includes("roles_edit"))
                      |  · 
                      a(href="javascript:;" data-id=record.id button-edit) Sửa
                    if(role.permissions.includes("roles_delete"))
                      |  · 
                      a(href="javascript:;" data-id=record.id button-delete) Xóa
                  td #{record.description || '—'}
                  td
                    p.mb-1 #{record.accountFullName || '—'}
                    p.mb-1
                      if record.createdBy && record.createdBy.createdAt
                        +formatDateTime(record.createdBy.createdAt)
                      else
                        | —
            else
              tr
                td(colspan="4" class="text-center text-muted py-4")
                  | Không có dữ liệu nhóm quyền



        form(
          action=""
          method="POST"
          form-delete
          data-path=`${prefixAdmin}/roles/delete`
        )

        form(
          action=""
          method="GET"
          form-edit
          data-path=`${prefixAdmin}/roles/edit`
        )

        form(
          action=""
          method="GET"
          form-detail
          data-path=`${prefixAdmin}/roles/detail`
        )