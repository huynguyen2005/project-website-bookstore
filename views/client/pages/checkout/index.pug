extends ../../layouts/default.pug
include ../../mixins/formatPrice.pug

block styles
  link(rel="stylesheet" href="/client/css/cart.css")

block main

  .checkout-page.container.py-5
    h2.checkout-title Thanh toán đơn hàng
    p.checkout-subtitle Vui lòng nhập thông tin giao hàng của bạn

    if cart.books.length > 0
      form(action="/checkout/order" method="POST" class="checkout-form")

        //===== DANH SÁCH SẢN PHẨM =====//
        h3.section-title Sản phẩm trong giỏ hàng
        table.cart-table
          thead
            tr
              th
              th Tên sản phẩm
              th Giá
              th Số lượng
              th Thành tiền
          tbody
            each item in cart.books
              tr.cart-row
                td.thumb-col
                  img.thumb(src=item.bookInfor.thumbnail alt=item.bookInfor.bookName)
                td.name-col
                  span #{item.bookInfor.bookName}
                td.price-col
                  span.new-price
                    +formatPrice(item.bookInfor.newPrice)
                  if item.bookInfor.discountPercent > 0
                    span.old-price
                      +formatPrice(item.bookInfor.price)
                td.qty-col= item.quantity
                td.total-col
                  +formatPrice(item.totalPrice)

        //===== TỔNG TIỀN =====//
        .order-summary.mt-4
          h4 Thông tin đơn hàng
          p Tổng tiền: 
            span.total-price
              +formatPrice(cart.total)

        //===== THÔNG TIN GIAO HÀNG =====//
        .shipping-info.mb-5
          h3.section-title Thông tin giao hàng

          .form-group
            label(for="fullName") Họ và tên
            input#name.form-control(type="text" name="fullName" required placeholder="Nhập họ và tên của bạn" value=user.fullName)

          .form-group
            label(for="phone") Số điện thoại
            input#phone.form-control(type="tel" name="phone" required placeholder="Nhập số điện thoại" value=user.phone)

          .form-group
            label(for="address") Địa chỉ
            input#address.form-control(type="text" name="address" required placeholder="Nhập địa chỉ nhận hàng" value=user.address)

          .form-group
            label(for="note") Ghi chú đơn hàng
            textarea#note.form-control(name="note" rows="3" placeholder="Ghi chú (tuỳ chọn)")

          p.small.text-muted Phí vận chuyển: Miễn phí

        //===== PHƯƠNG THỨC THANH TOÁN =====//
        .payment-methods.mb-5
          h3.section-title Phương thức thanh toán

          .card
            .card-body
              // COD - Thanh toán khi nhận hàng (Bootstrap icon)
              .form-check.mb-3
                input#cod.form-check-input(type="radio" name="paymentMethod" value="COD" checked)
                label.form-check-label(for="cod")
                  i(class="bi bi-box-seam mr-2 text-primary") 
                  | Thanh toán khi nhận hàng (COD)

              // Chuyển khoản ngân hàng
              .form-check.mb-3
                input#bank.form-check-input(type="radio" name="paymentMethod" value="bank_transfer" disabled)
                label.form-check-label(for="bank")
                  i(class="bi bi-bank mr-2 text-success")
                  | Chuyển khoản qua ngân hàng (Đang update...)

              // Thẻ ATM nội địa
              .form-check.mb-3
                input#atm.form-check-input(type="radio" name="paymentMethod" value="atm_onepay" disabled)
                label.form-check-label(for="atm")
                  i(class="bi bi-credit-card-2-front mr-2 text-info")
                  | Thẻ ATM nội địa qua cổng OnePay (Đang update...)

              // Visa/Master/JCB
              .form-check.mb-3
                input#visa.form-check-input(type="radio" name="paymentMethod" value="visa_onepay" disabled)
                label.form-check-label(for="visa")
                  i(class="bi bi-credit-card mr-2 text-warning")
                  | Thẻ Visa / Master / JCB / Amex / CUP qua cổng OnePay (Đang update...)

              // MoMo
              .form-check
                input#momo.form-check-input(type="radio" name="paymentMethod" value="momo" disabled)
                label.form-check-label(for="momo")
                  i(class="bi bi-phone-vibrate mr-2 text-danger")
                  | Ví MoMo (Đang update...)

        //===== NÚT =====//
        .checkout-actions.mt-4
          button.btn.btn-primary.btn-checkout(type="submit") ĐẶT HÀNG
          a.btn-continue(href="/cart") Quay lại giỏ hàng

    else
      .empty-cart
        h3 Giỏ hàng trống
        a.btn.btn-light(href="/") Quay lại mua hàng
