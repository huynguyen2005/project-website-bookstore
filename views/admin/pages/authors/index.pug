extends ../../layouts/default
include ../../mixins/search.pug
include ../../mixins/formatDateTime.pug
include ../../mixins/alert.pug

block main
  +alert-success(5000)
  +alert-error(5000)
  if(role.permissions.includes("authors_view"))
    .card
      .card-header.d-flex.justify-content-between.align-items-center
        h5.mb-0 Danh sách tác giả

        if(role.permissions.includes("authors_create"))
          a.btn.btn-primary(href=`${prefixAdmin}/authors/create`)
            | + Thêm mới

      .card-body
        // --- Thanh tìm kiếm ---
        .d-flex.align-items-center.mb-3
          +search(keyword, "authors")

        // --- Bảng danh sách tác giả ---
        table.table.table-hover.table-bordered(check-box-multi)
          thead.thead-light
            tr
              th
                input(type="checkbox" check-box-all)
              th Tên tác giả
              th Người tạo
          tbody
            if records.length
              each record in records
                tr
                  td
                    input(type="checkbox" name="id" value=record.id)
                  td
                    strong #{record.fullName}
                    br
                    a(href="javascript:;" data-id=record.id button-detail) Xem
                    if(role.permissions.includes("authors_edit"))
                      |  · 
                      a(href="javascript:;" data-id=record.id button-edit) Sửa
                    if(role.permissions.includes("authors_delete"))
                      |  · 
                      a(href="javascript:;" data-id=record.id button-delete) Xóa
                  td
                    p.mb-1 #{record.accountFullName || '—'}
                    p.mb-1
                      if record.createdBy && record.createdBy.createdAt
                        +formatDateTime(record.createdBy.createdAt)
                      else
                        | —
            else
              tr
                td(colspan="3" class="text-center text-muted py-4")
                  | Không có dữ liệu tác giả


        // Form Delete
        form(
          action=""
          method="POST"
          form-delete
          data-path=`${prefixAdmin}/authors/delete`
        )
        // Form Edit
        form(
          action=""
          method="GET"
          form-edit
          data-path=`${prefixAdmin}/authors/edit`
        )
        // Form Detail
        form(
          action=""
          method="GET"
          form-detail
          data-path=`${prefixAdmin}/authors/detail`
        )
